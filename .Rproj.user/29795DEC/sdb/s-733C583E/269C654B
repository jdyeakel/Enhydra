{
    "contents" : "rm(list=c(ls()))\n\nlibrary(siar)\nlibrary(ellipse)\nlibrary(RColorBrewer)\n\n\ndata <- read.csv(file=\"Consumers-Table 1.csv\",header=TRUE)\n#Eliminate the ear samples\ndata <- data[-which(data$tissue == \"Ear\"),]\n\nsp <- data$species\nn.sp <- length(levels(sp))\nid <- data$ID\n\n#Calculate D15N for each species in each site\nconsumers <- levels(sp)[-7]\nD15N <- numeric(length(consumers))\nD15Nsd <- numeric(length(consumers))\nD13C <- numeric(length(consumers))\nDMass <- numeric(length(consumers))\nmean.se.np <- numeric(length(consumers))\nmean.se.p <- numeric(length(consumers))\nsd.se.np <- numeric(length(consumers))\nsd.se.p <- numeric(length(consumers))\nd15N.list.np <- list()\nd15N.list.p <- list()\nd13C.list.np <- list()\nd13C.list.p <- list()\niso.table.p <- list()\niso.table.np <- list()\ne.p <- list()\ne.np <- list()\n\n#Ellipse of pecarries\nrows.pecc <- which(data$species == \"Tayassu pecari\")\nd13C.pecc <- data$X13C[rows.pecc]\nd15N.pecc <- data$X15N[rows.pecc]\niso.table.pecc <- cbind(d13C.pecc,d15N.pecc)\nCI <- 0.95\nSigma.pecc <- cov(cbind(d13C.pecc,d15N.pecc))\nSigma.pecc <- Sigma.pecc * 3\nmu.pecc <- c(mean(d13C.pecc),mean(d15N.pecc))\ne.pecc <- ellipse(Sigma.pecc,centre=mu.pecc,level=CI)\noverlap.p <- numeric(length(consumers))\noverlap.np <- numeric(length(consumers))\noverlap.ratio <- numeric(length(consumers))\n\noverlap.siber.p <- numeric(length(consumers))\noverlap.siber.np <- numeric(length(consumers))\noverlap.siber.ratio <- numeric(length(consumers))\n\n#for (i in 1:length(consumers)) {\nfor (i in c(1,2,4,6,7,8)) {\n  print(i)\n  cons <- consumers[i]\n  sub.data <- data[which(data$species == cons),]\n  \n  np.rows <- which(sub.data$status == \"No-peccarie\")\n  p.rows <- which(sub.data$status == \"Peccarie\")\n  d15N.np <- sub.data$X15N[np.rows]\n  d15N.p <- sub.data$X15N[p.rows]\n  d13C.np <- sub.data$X13C[np.rows]\n  d13C.p <- sub.data$X13C[p.rows]\n  mass.np <- sub.data$mass[np.rows]\n  mass.p <- sub.data$mass[p.rows]\n  \n  #Save original d13C and d15N values for np and p\n  d15N.list.np[[i]] <- d15N.np\n  d15N.list.p[[i]] <- d15N.p\n  d13C.list.np[[i]] <- d13C.np\n  d13C.list.p[[i]] <- d13C.p\n  \n  iso.table.p[[i]] <- cbind(d13C.list.p[[i]],d15N.list.p[[i]])\n\n  iso.table.np[[i]] <- cbind(d13C.list.np[[i]],d15N.list.np[[i]])\n  \n  D15N[i] <- mean(d15N.np) - mean(d15N.p)\n  D15Nsd[i] <- sd(d15N.np) - sd(d15N.p)\n  \n  D13C[i] <- mean(d13C.np) - mean(d13C.p)\n  \n  DMass[i] <- mean(mass.np[which(is.na(mass.np)==F)]) - mean(mass.p[which(is.na(mass.p)==F)])\n  \n  if (length(iso.table.p[[i]][,1]) > 1) {\n    Sigma.p <- cov(cbind(d13C.p,d15N.p))\n    mu.p <- c(mean(d13C.p),mean(d15N.p))\n    e.p[[i]] <- ellipse(Sigma.p,centre=mu.p,level=CI)\n  } else {e.p[[i]] <- NA}\n  if (length(iso.table.np[[i]][,1]) > 1) {\n    Sigma.np <- cov(cbind(d13C.np,d15N.np))\n    mu.np <- c(mean(d13C.np),mean(d15N.np))\n    e.np[[i]] <- ellipse(Sigma.np,centre=mu.np,level=CI)\n  } else {e.np[[i]] <- NA}\n  \n  #Determine overlap between species i and pecarries\n  if (i %in% c(1,2,4,6,7)) { #ensure there are at least 3 datapoints\n    \n    overlap.p[i] <- (((det(Sigma.p %*% Sigma.pecc))^(1/4)) / (det((1/2) * (Sigma.p + Sigma.pecc)))^(1/2)) * (exp((-1/2) * t(mu.p - mu.pecc) %*% ginv(Sigma.p + Sigma.pecc) %*% (mu.p - mu.pecc))) + 1\n    overlap.np[i] <- (((det(Sigma.np %*% Sigma.pecc))^(1/4)) / (det((1/2) * (Sigma.np + Sigma.pecc)))^(1/2)) * (exp((-1/2) * t(mu.np - mu.pecc) %*% ginv(Sigma.np + Sigma.pecc) %*% (mu.np - mu.pecc))) + 1\n    overlap.ratio[i] <- overlap.np[i] / overlap.p[i]\n    \n    overlap.siber.p[i] <- overlap(d13C.p,d15N.p,d13C.pecc,d15N.pecc)$overlap + 1\n    overlap.siber.np[i] <- overlap(d13C.np,d15N.np,d13C.pecc,d15N.pecc)$overlap + 1\n    overlap.siber.ratio[i] <-  overlap.np[i] / overlap.siber.p[i]\n    \n  } else {\n    overlap.p[i] <- NA\n    overlap.np[i] <- NA\n    overlap.ratio[i] <- NA\n    overlap.siber.p[i] <- NA\n    overlap.siber.np[i] <- NA\n    overlap.siber.ratio[i] <- NA\n  }\n  \n  #Elliptical Measurements\n#   se.np <- siber.ellipses(x=sub.data$X13C[np.rows],y=sub.data$X15N[np.rows],\n#                           group = rep(1,length(np.rows)), R=10^4)\n#   se.p <- siber.ellipses(x=sub.data$X13C[p.rows],y=sub.data$X15N[p.rows],\n#                          group = rep(1,length(p.rows)),R=10^4)\n#   mean.se.np[i] <- mean(se.np)\n#   sd.se.np[i] <- sd(se.np)\n#   \n#   mean.se.p[i] <- mean(se.p)\n#   sd.se.p[i] <- sd(se.p)\n}\n\n#Abudances in defaunated vs. non-defaunated environments\n# [1] \"Akodon montensis\"            \"Brucepattersonius soricinus\"\n# [3] \"Didelphis aurita\"            \"Euryoryzomys russatus\"      \n# [5] \"Marmosops incanus\"           \"Oligoryzomys nigripes\"      \n# [7] \"Thaptomys nigrita\"           \"Trinomys iheringi\"    \nabundance.np <- c(67,10,6,84,18,42,106,1)\nabundance.p <- c(23,7,3,86,13,21,45,9)\nD.abundance <- abundance.p - abundance.np\nD.abundance.prop <-  abundance.np / abundance.p\n\n####################\n# D13C and D15N FIG\n####################\npar(mfrow=c(1,2))\nconsumer_names = c(\"Akodon\",\"Brucepattersonius\",\"Didelphis\",\"Euryoryzomys\", \"Marmosops\",\"Oligoryzomys\",\"Thaptomys\",\"Trinomys\")\nconsumer_names = c(\"Akodon\",\"Brucepattersonius\",\"Euryoryzomys\",\"Oligoryzomys\",\"Thaptomys\",\"Trinomys\")\n#D13C Plot\nplot(D.abundance.prop,D13C,xlim=c(0,3.5),ylim=c(-3.2,1),pch=16,ylab=expression(paste(delta^\"13\",\"C\"[\"Peccary-absent\"],\" - \",delta^\"13\",\"C\"[\"Peccary\"])),xlab = expression(paste(\"Abundance\"[\"Peccary-absent\"],\"/Abundance\"[\"Peccary\"])))\ntext(x=D.abundance.prop+0.15,y=D13C+0.12,labels=consumer_names,cex=0.75,font=3)\nlmodel_C <- lm(D13C ~ D.abundance.prop)\nabline(lmodel_C,lty=3)\n#D15N Plot\nplot(D.abundance.prop,D15N,xlim=c(0,3.5),ylim=c(-3.2,1),pch=16,ylab=expression(paste(delta^\"15\",\"N\"[\"Peccary-absent\"],\" - \",delta^\"15\",\"N\"[\"Peccary\"])),xlab = expression(paste(\"Abundance\"[\"Peccary-absent\"],\"/Abundance\"[\"Peccary\"])))\ntext(x=D.abundance.prop+0.15,y=D15N+0.15,labels=consumer_names,cex=0.75,font=3)\nlmodel_N <- lm(D15N ~ D.abundance.prop)\nabline(lmodel_N,lty=3)\n\n####################\n# OVERLAP RATIO FIG\n####################\npar(mfrow=c(1,1))\noverlap.ratio.na <- overlap.ratio[-c(3,5,8)]\noverlap.siber.ratio.na <- overlap.siber.ratio[-c(3,5,8)]\nconsumer_names.na <- consumer_names[-6]\n#Barplot for overlap.ratio\nbarplot(overlap.siber.ratio.na,ylim=c(0.9,1.8),xpd=FALSE,ylab=\"Similarity Index\")\nlines(seq(0,8,length.out=8),rep(1,8),lty=3)\nlablist.x<-consumer_names.na\noffset <- 0\naxis(1, at=seq(0.75-offset, 10-offset, by=1.19), labels = FALSE,tick=TRUE)\n#text(x = seq(1-offset, 8-offset, by=1.2), par(\"usr\")[3] - 0.05, \n    # labels = lablist.x, srt = 45, pos = 2, xpd = TRUE, cex = 0.8)\n#offset <- 0\ntext(x = seq(0.75-offset, 8-offset, by=1.19), 1.1, labels=c(\"+\",\"o\",\"+\",\"o\",\"-\"))\n\n####################\n# Isospace FIG\n####################\n# PECCARIES\npar(mfrow=c(2,1))\ncolors <- brewer.pal(8,\"Set2\")\nplot(iso.table.pecc,xlim=c(-27,-12),ylim=c(0,12),pch=16,col=\"black\",ylab=expression(paste(delta^\"15\",\"N\")),xlab=expression(paste(delta^\"13\",\"C\")),main=\"Peccaries\")\nlines(e.pecc)\nfor (i in 1:8) {\n  polygon(e.p[[i]],col=paste(colors[i],\"50\",sep=\"\"),border=FALSE)\n  points(iso.table.p[[i]],pch=16,col=colors[i])\n  #lines(e.p[[i]])\n}\ncolors.legend <- colors[-c(3,5)]\nlegend(x=-17,y=6,legend=c(\"Tayassu\",consumer_names),cex=0.75,col=c(\"#000000\",colors.legend),pch=16,border=FALSE,bty=\"n\")\n# NO PECCARIES\nplot(iso.table.pecc,xlim=c(-27,-12),ylim=c(0,12),pch=16,col=\"white\",ylab=expression(paste(delta^\"15\",\"N\")),xlab=expression(paste(delta^\"13\",\"C\")),main=\"Peccaries-absent\")\nlines(e.pecc)\nfor (i in 1:8) {\n  polygon(e.np[[i]],col=paste(colors[i],\"50\",sep=\"\"),border=FALSE)\n  points(iso.table.np[[i]],pch=16,col=colors[i])\n  #lines(e.p[[i]])\n}\n\n\n####################\n# Isospace FIG USING SIBER ELLIPSES\n####################\n# PECCARIES\npar(mfrow=c(2,1))\ncolors <- brewer.pal(8,\"Set2\")\nplot(iso.table.pecc,xlim=c(-27,-12),ylim=c(0,12),pch=16,col=\"black\",ylab=expression(paste(delta^\"15\",\"N\")),xlab=expression(paste(delta^\"13\",\"C\")),main=\"Peccaries\")\nlines(e.pecc)\nfor (i in 1:8) {\n  polygon(e.p[[i]],col=paste(colors[i],\"50\",sep=\"\"),border=FALSE)\n  points(iso.table.p[[i]],pch=16,col=colors[i])\n  #lines(e.p[[i]])\n}\ncolors.legend <- colors[-c(3,5)]\nlegend(x=-17,y=6,legend=c(\"Tayassu\",consumer_names),cex=0.75,col=c(\"#000000\",colors.legend),pch=16,border=FALSE,bty=\"n\")\n# NO PECCARIES\nplot(iso.table.pecc,xlim=c(-27,-12),ylim=c(0,12),pch=16,col=\"white\",ylab=expression(paste(delta^\"15\",\"N\")),xlab=expression(paste(delta^\"13\",\"C\")),main=\"Peccaries-absent\")\nlines(e.pecc)\nfor (i in 1:8) {\n  polygon(e.np[[i]],col=paste(colors[i],\"50\",sep=\"\"),border=FALSE)\n  points(iso.table.np[[i]],pch=16,col=colors[i])\n  #lines(e.p[[i]])\n}\n\n\nconsumer_names = c(\"Akodon\",\"Brucepattersonius\",\"Didelphis\",\"Euryoryzomys\", \"Marmosops\",\"Oligoryzomys\",\"Thaptomys\",\"Trinomys\")\nbarplot(overlap.siber.ratio,ylim=c(0,2))\nlines(seq(0,10,length.out=10),rep(1,10),lty=3)\nlablist.x<-consumer_names\naxis(1, at=seq(1, 8, by=1), labels = FALSE,tick=FALSE)\noffset <- 0\ntext(x = seq(1-offset, 10-offset, by=1.2), par(\"usr\")[3] - 0.1, \n     labels = lablist.x, srt = 45, pos = 2, xpd = TRUE, cex = 0.8)\n\n\n#Barplot for all rodents together (pecarries and no pecarries) ~ Here, well-sampled rodents carry more weight\nbarplot(c(mean(unlist(d15N.list.np)),mean(unlist(d15N.list.p))))\nplot(jitter(rbind(cbind(rep(1,length(unlist(d15N.list.np))),unlist(d15N.list.np)),cbind(rep(2,length(unlist(d15N.list.p))),unlist(d15N.list.p)))),xlim=c(0,3))\nboxplot(unlist(d15N.list.np),unlist(d15N.list.p),ylim=c(0,15),boxwex=0.25,names=c(\"defaunated\",\"non-defaunated\"))\n\nd15N.data <- rbind(cbind(rep(1,length(unlist(d15N.list.np))),unlist(d15N.list.np)),cbind(rep(2,length(unlist(d15N.list.p))),unlist(d15N.list.p)))\nd15N.frame <- data.frame(d15N.data)\nfm1 <- aov(d15N.frame[,2] ~ d15N.frame[,1])\nanova(fm1)\n\n#Barplot by means...\nmeans.np <- unlist(lapply(d15N.list.np,mean))\nmeans.p <- unlist(lapply(d15N.list.p,mean))\nboxplot(means.np,means.p,ylim=c(0,15),boxwex=0.25,names=c(\"defaunated\",\"non-defaunated\"))\n#AOV\nd15N.data <- rbind(cbind(rep(1,length(means.np)),means.np),cbind(rep(2,length(means.p)),means.p))\nd15N.frame <- data.frame(d15N.data)\nfm1 <- aov(d15N.frame[,2] ~ d15N.frame[,1])\nsummary(fm1)\n\n#Do same thing but without species whose sample sizes are <= 3\nsubset.np <- which(unlist(lapply(d15N.list.np,length)) > 2)\nsubset.p <- which(unlist(lapply(d15N.list.p,length)) > 2)\n\n#Abudances in defaunated vs. non-defaunated environments\n# [1] \"Akodon montensis\"            \"Brucepattersonius soricinus\"\n# [3] \"Didelphis aurita\"            \"Euryoryzomys russatus\"      \n# [5] \"Marmosops incanus\"           \"Oligoryzomys nigripes\"      \n# [7] \"Thaptomys nigrita\"           \"Trinomys iheringi\"    \nabundance.np <- c(67,10,6,84,18,42,106,1)\nabundance.p <- c(23,7,3,86,13,21,45,9)\n\nD.abundance <- abundance.p - abundance.np\nD.abundance.prop <-  abundance.np / abundance.p\n\n\n#Abundance Ratio vs. Overlap Ratio\nD.abundance.prop.na <- D.abundance.prop; D.abundance.prop.na[c(3,8)] <- NA\nplot(overlap.ratio,D.abundance.prop.na)\n\n\n\nconsumers = c(\"Akodon\",\"Brucepattersonius\",\"Didelphis\",\"Euryoryzomys\", \"Marmosops\",\"Oligoryzomys\",\"Thaptomys\",\"Trinomys\")\npar(xaxt=\"n\") \nbarplot(D15N,xlab=\"\",ylab=\"Change in mean d15N\",pch=16)\nlines(cbind(seq(0,10),rep(0,11)),lty=3)\nlablist.x<-consumers\naxis(1, at=seq(1, 8, by=1), labels = FALSE)\noffset <- 0\ntext(x = seq(1-offset, 8-offset, by=1), par(\"usr\")[3] - 0.2, \n     labels = lablist.x, srt = 45, pos = 2, xpd = TRUE, cex = 0.8)\n\n#D15N vs. DAbundance\ndev.off()\nplot(D.abundance.prop,D15N,xlim=c(0,3.5),ylim=c(-1,3.2),pch=16,ylab=expression(paste(delta^\"15\",\"N\"[\"Peccary-absent\"],\" - \",delta^\"15\",\"N\"[\"Peccary\"])))\ntext(x=D.abundance.prop+0.15,y=D15N+0.15,labels=consumer_names)\nlmodel <- lm(D15N ~ D.abundance.prop)\nabline(lmodel,lty=3)\n\n#D15N SD vs. DAbundance\ndev.off()\nplot(D.abundance.prop,D15Nsd,xlim=c(0.5,3),ylim=c(-1,1),pch=16,ylab=\"d15N sd(No Pecarry) - d15N sd(Pecarry)\",xlab=\"Abundance(No Peccary)/Abundance(Peccary)\")\ntext(x=D.abundance.prop,y=D15Nsd+0.15,labels=consumers)\nlmodelsd <- lm(D15Nsd ~ D.abundance.prop)\nabline(lmodelsd,lty=3)\n\nD15N.sort <- sort(D15N,index.return=TRUE)\nconsumers = c(\"Akodon\",\"Brucepattersonius\",\"Didelphis\",\"Euryoryzomys\", \"Marmosops\",\"Oligoryzomys\",\"Thaptomys\",\"Trinomys\")\nDMass.scaled <- DMass[D15N.sort$ix] + abs(min(DMass))\npar(xaxt=\"s\") \nbarplot(D15N.sort$x,ylim=c(-1,3),xlab=\"\",\n        ylab = expression(paste(delta^\"15\",\"N\"[\"non-defaunated\"],\" - \",delta^\"15\",\"N\"[\"defaunated\"])),pch=16)\nlines(cbind(seq(0,10),rep(0,11)),lty=3)\nlablist.x<-consumers[D15N.sort$ix]\n#axis(1, at=seq(1, 8, by=1), labels = FALSE)\ntext(x = seq(1, 9.2, length.out=8), par(\"usr\")[3] - 0.2, \n     labels = lablist.x, srt = 45, pos = 2, xpd = TRUE, cex = 0.8)\n\n\n#Take out large SD samples\n# mean.se.p <- mean.se.p[-c(3,8)]\n# sd.se.p <- sd.se.p[-c(3,8)]\n# mean.se.np <- mean.se.np[-c(3,8)]\n# sd.se.np <- sd.se.np[-c(3,8)]\n# consumers <- consumers[-c(3,8)]\n\npar(xaxt=\"s\") \nplot(mean.se.p,mean.se.np,xlim=c(0,10),ylim=c(0,10),\n     xlab=\"Ellipsoid Area: Non-defaunated\",ylab=\"Ellipsoid Area: Defaunated\")\n# segments(mean.se.p,mean.se.np,mean.se.p+sd.se.p,mean.se.np)\n# segments(mean.se.p,mean.se.np,mean.se.p-sd.se.p,mean.se.np)\n# segments(mean.se.p,mean.se.np,mean.se.p,mean.se.np+sd.se.np)\n# segments(mean.se.p,mean.se.np,mean.se.p,mean.se.np-sd.se.np)\ntext(x=mean.se.p +0.5,y=mean.se.np+0.5,labels=consumers,cex=0.8)\nlines(seq(-1,12),seq(-1,12),lty=3)\n\n\n#Main findings\n#Little Change in niche breadth\n#There ARE differential changes in d15N...\n\n\n#Analysis of resources\ndata.r <- read.csv(file=\"Resources-Table 1.csv\",header=TRUE)\n#Eliminate the ear samples\n#data <- data[-which(data$tissue == \"Ear\"),]\n\nsp <- data.r$species\nn.sp <- length(levels(sp))\nid <- data.r$ID\n\n#Calculate D15N for each species in each site\nresources <- levels(sp)\nD15N.r <- numeric(length(resources))\nD15Nsd.r <- numeric(length(resources))\n#DMass <- numeric(length(consumers))\n#mean.se.np <- numeric(length(consumers))\n#mean.se.p <- numeric(length(consumers))\n#sd.se.np <- numeric(length(consumers))\n#sd.se.p <- numeric(length(consumers))\nd13C.np.raw <- list()\nd13C.p.raw <- list()\nd15N.np.raw <- list()\nd15N.p.raw <- list()\n\nfor (i in 1:length(resources)) {\n  res <- resources[i]\n  sub.data <- data.r[which(data.r$species == res),]\n  \n  np.rows <- which(sub.data$status == \"No-peccarie\")\n  p.rows <- which(sub.data$status == \"Peccarie\")\n  d15N.np <- sub.data$X15N[np.rows]\n  d15N.p <- sub.data$X15N[p.rows]\n  d15N.np.raw[[i]] <- d15N.np\n  d15N.p.raw[[i]] <- d15N.p\n  \n  d13C.np <- sub.data$X13C[np.rows]\n  d13C.p <- sub.data$X13C[p.rows]\n  d13C.np.raw[[i]] <- d13C.np\n  d13C.p.raw[[i]] <- d13C.p\n  \n  #mass.np <- sub.data$mass[np.rows]\n  #mass.p <- sub.data$mass[p.rows]\n  \n  D15N.r[i] <- mean(d15N.np) -  mean(d15N.p)\n  D15Nsd.r[i] <- sd(d15N.np) -  sd(d15N.p)\n  \n  #DMass[i] <- mean(mass.np[which(is.na(mass.np)==F)]) - mean(mass.p[which(is.na(mass.p)==F)])\n  \n  #Elliptical Measurements\n  #se.np <- siber.ellipses(x=sub.data$X13C[np.rows],y=sub.data$X15N[np.rows],\n                          #group = rep(1,length(np.rows)), R=10^4)\n  #se.p <- siber.ellipses(x=sub.data$X13C[p.rows],y=sub.data$X15N[p.rows],\n                         #group = rep(1,length(p.rows)),R=10^4)\n  #mean.se.np[i] <- mean(se.np)\n  #sd.se.np[i] <- sd(se.np)\n  \n  #mean.se.p[i] <- mean(se.p)\n  #sd.se.p[i] <- sd(se.p)\n}\n\n#Isotope Plot\nlibrary(RColorBrewer)\n\n#par(mfrow=c(1,1))\ncolors <- brewer.pal(8,\"Set2\")\nplot(mean(d13C.np.raw[[1]]),mean(d15N.np.raw[[1]]),xlim=c(-35,-22),ylim=c(-5,12),pch=1,col=colors[1],xlab=\"d13C\",ylab=\"d15N\")\ntext(mean(d13C.np.raw[[1]])+1,mean(d15N.np.raw[[1]])+0.5,resources[1],col=colors[1])\nsegments(mean(d13C.np.raw[[1]]),mean(d15N.np.raw[[1]]),mean(d13C.np.raw[[1]])-sd(d13C.np.raw[[1]]),mean(d15N.np.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\nsegments(mean(d13C.np.raw[[1]]),mean(d15N.np.raw[[1]]),mean(d13C.np.raw[[1]])+sd(d13C.np.raw[[1]]),mean(d15N.np.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\nsegments(mean(d13C.np.raw[[1]]),mean(d15N.np.raw[[1]]),mean(d13C.np.raw[[1]]),mean(d15N.np.raw[[1]])+sd(d15N.np.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\nsegments(mean(d13C.np.raw[[1]]),mean(d15N.np.raw[[1]]),mean(d13C.np.raw[[1]]),mean(d15N.np.raw[[1]])-sd(d15N.np.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\n\npoints(mean(d13C.p.raw[[1]]),mean(d15N.p.raw[[1]]),xlim=c(-35,-22),ylim=c(-5,12),pch=16,col=colors[1],xlab=\"d13C\",ylab=\"d15N\")\n#text(mean(d13C.p.raw[[1]])+1,mean(d15N.p.raw[[1]])+0.5,resources[1],col=colors[1])\nsegments(mean(d13C.p.raw[[1]]),mean(d15N.p.raw[[1]]),mean(d13C.p.raw[[1]])-sd(d13C.p.raw[[1]]),mean(d15N.p.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\nsegments(mean(d13C.p.raw[[1]]),mean(d15N.p.raw[[1]]),mean(d13C.p.raw[[1]])+sd(d13C.p.raw[[1]]),mean(d15N.p.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\nsegments(mean(d13C.p.raw[[1]]),mean(d15N.p.raw[[1]]),mean(d13C.p.raw[[1]]),mean(d15N.p.raw[[1]])+sd(d15N.p.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\nsegments(mean(d13C.p.raw[[1]]),mean(d15N.p.raw[[1]]),mean(d13C.p.raw[[1]]),mean(d15N.p.raw[[1]])-sd(d15N.p.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\n\n#c(2,3,5) excludes leaves.\nfor(i in c(2,3,5)) {\n  points(mean(d13C.np.raw[[i]]),mean(d15N.np.raw[[i]]),pch=1,col=colors[i])\n  text(mean(d13C.np.raw[[i]])+1,mean(d15N.np.raw[[i]])+0.5,resources[i],col=colors[i])\n  segments(mean(d13C.np.raw[[i]]),mean(d15N.np.raw[[i]]),mean(d13C.np.raw[[i]])-sd(d13C.np.raw[[i]]),mean(d15N.np.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  segments(mean(d13C.np.raw[[i]]),mean(d15N.np.raw[[i]]),mean(d13C.np.raw[[i]])+sd(d13C.np.raw[[i]]),mean(d15N.np.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  segments(mean(d13C.np.raw[[i]]),mean(d15N.np.raw[[i]]),mean(d13C.np.raw[[i]]),mean(d15N.np.raw[[i]])+sd(d15N.np.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  segments(mean(d13C.np.raw[[i]]),mean(d15N.np.raw[[i]]),mean(d13C.np.raw[[i]]),mean(d15N.np.raw[[i]])-sd(d15N.np.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n\n  points(mean(d13C.p.raw[[i]]),mean(d15N.p.raw[[i]]),pch=16,col=colors[i])\n  segments(mean(d13C.p.raw[[i]]),mean(d15N.p.raw[[i]]),mean(d13C.p.raw[[i]])-sd(d13C.p.raw[[i]]),mean(d15N.p.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  segments(mean(d13C.p.raw[[i]]),mean(d15N.p.raw[[i]]),mean(d13C.p.raw[[i]])+sd(d13C.p.raw[[i]]),mean(d15N.p.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  segments(mean(d13C.p.raw[[i]]),mean(d15N.p.raw[[i]]),mean(d13C.p.raw[[i]]),mean(d15N.p.raw[[i]])+sd(d15N.p.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  segments(mean(d13C.p.raw[[i]]),mean(d15N.p.raw[[i]]),mean(d13C.p.raw[[i]]),mean(d15N.p.raw[[i]])-sd(d15N.p.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  \n}\n\nd13C.all.raw <- list()\nd15N.all.raw <- list()\n\nfor (i in 1:5) {\n  d13C.all.raw[[i]] <- c(d13C.p.raw[[i]],d13C.np.raw[[i]])\n  d15N.all.raw[[i]] <- c(d15N.p.raw[[i]],d15N.np.raw[[i]])\n}\niso.res <- list()\nfor (i in 1:5) {\n  iso.res[[i]] <- cbind(d13C.all.raw[[i]],d15N.all.raw[[i]])\n}\ncolors <- brewer.pal(8,\"Set2\")\nplot(rbind(apply(iso.res[[1]],2,mean)),xlim=c(-38,-20),ylim=c(-5,18),pch=16,col=colors[1],xlab=\"d13C\",ylab=\"d15N\")\npolygon(ellipse(cov(iso.res[[1]]),centre=apply(iso.res[[1]],2,mean),level=CI),col=paste(colors[1],\"50\",sep=\"\"),border=FALSE)\nfor (i in c(2,3,5)) {\n  points(rbind(apply(iso.res[[i]],2,mean)),xlim=c(-35,-22),ylim=c(-5,12),pch=16,col=colors[i])\n  polygon(ellipse(cov(iso.res[[i]]),centre=apply(iso.res[[i]],2,mean),level=CI),col=paste(colors[i],\"50\",sep=\"\"),border=FALSE)\n}\n#plot points again for clarity\nfor (i in c(1,2,3,5)) {\n  points(rbind(apply(iso.res[[i]],2,mean)),xlim=c(-35,-22),ylim=c(-5,12),pch=16,col=colors[i])\n}\n\ndisplay.brewer.all()\n\ncolors <- brewer.pal(8,\"Dark2\")\nplot(rbind(apply(iso.res[[1]],2,mean)),xlim=c(-34,-22),ylim=c(-2,12),pch=16,col=colors[1],xlab=\"d13C\",ylab=\"d15N\")\ntext(mean(d13C.all.raw[[1]])+1,mean(d15N.all.raw[[1]])+0.5,resources[1],col=colors[1])\nsegments(mean(d13C.all.raw[[1]]),mean(d15N.all.raw[[1]]),mean(d13C.all.raw[[1]])-sd(d13C.all.raw[[1]]),mean(d15N.all.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\nsegments(mean(d13C.all.raw[[1]]),mean(d15N.all.raw[[1]]),mean(d13C.all.raw[[1]])+sd(d13C.all.raw[[1]]),mean(d15N.all.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\nsegments(mean(d13C.all.raw[[1]]),mean(d15N.all.raw[[1]]),mean(d13C.all.raw[[1]]),mean(d15N.all.raw[[1]])+sd(d15N.all.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\nsegments(mean(d13C.all.raw[[1]]),mean(d15N.all.raw[[1]]),mean(d13C.all.raw[[1]]),mean(d15N.all.raw[[1]])-sd(d15N.all.raw[[1]]),lwd=3,col=paste(colors[1],\"70\",sep=\"\"))\n#c(2,3,5) excludes leaves.\nfor(i in c(2,3,5)) {  \n  points(mean(d13C.all.raw[[i]]),mean(d15N.all.raw[[i]]),pch=16,col=colors[i])\n  text(mean(d13C.all.raw[[i]])+1,mean(d15N.all.raw[[i]])+0.5,resources[i],col=colors[i])\n  segments(mean(d13C.all.raw[[i]]),mean(d15N.all.raw[[i]]),mean(d13C.all.raw[[i]])-sd(d13C.all.raw[[i]]),mean(d15N.all.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  segments(mean(d13C.all.raw[[i]]),mean(d15N.all.raw[[i]]),mean(d13C.all.raw[[i]])+sd(d13C.all.raw[[i]]),mean(d15N.all.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  segments(mean(d13C.all.raw[[i]]),mean(d15N.all.raw[[i]]),mean(d13C.all.raw[[i]]),mean(d15N.all.raw[[i]])+sd(d15N.all.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n  segments(mean(d13C.all.raw[[i]]),mean(d15N.all.raw[[i]]),mean(d13C.all.raw[[i]]),mean(d15N.all.raw[[i]])-sd(d15N.all.raw[[i]]),lwd=3,col=paste(colors[i],\"70\",sep=\"\"))\n}\n\n\n\n\niso.fruit.np <- cbind(d13C.np.raw[[2]],d15N.np.raw[[2]])\niso.fruit.p <- cbind(d13C.p.raw[[2]],d15N.p.raw[[2]])\npoints(rbind(apply(iso.fruit.np,2,mean)),pch=1,col=colors[2])\npolygon(ellipse(cov(iso.fruit.np),centre=apply(iso.fruit.np,2,mean)),col=paste(colors[2],\"50\",sep=\"\"),border=FALSE)\npoints(rbind(apply(iso.fruit.p,2,mean)),col=colors[2],pch=16)\npolygon(ellipse(cov(iso.fruit.p),centre=apply(iso.fruit.p,2,mean)),col=paste(colors[2],\"50\",sep=\"\"),border=FALSE)\n\n\n\n#,col=paste(colors[i],\"50\",sep=\"\")\n#Is there a relationship in D15N for rodents and the foods they eat?\n\nlibrary(RColorBrewer)\ncols = brewer.pal(3,\"Set1\")\nbarplot(c(sort(D15N),sort(D15N.r)),ylab=\"d15N(No Pecarry) - d15N(Pecarry)\",\n        col=c(rep(cols[2],length(D15N)),rep(cols[3],length(D15N.r))))\n\nbarplot(c(sort(D15Nsd),sort(D15Nsd.r)),ylab=\"d15Nsd(No Pecarry) - d15Nsd(Pecarry)\",\n        col=c(rep(cols[2],length(D15Nsd)),rep(cols[3],length(D15Nsd.r))))\n\n\n\n\n\n",
    "created" : 1426280990544.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1256158060",
    "id" : "269C654B",
    "lastKnownWriteTime" : 1426278616,
    "path" : "~/Dropbox/2011_Mauro/Isospace analysis/Mauro_isospace/Isospace_analysis.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}